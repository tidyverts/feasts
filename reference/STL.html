<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiple seasonal decomposition by Loess — STL • feasts</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple seasonal decomposition by Loess — STL"><meta property="og:description" content="Decompose a time series into seasonal, trend and remainder components.
Seasonal components are estimated iteratively using STL. Multiple seasonal periods are
allowed. The trend component is computed for the last iteration of STL.
Non-seasonal time series are decomposed into trend and remainder only.
In this case, supsmu is used to estimate the trend.
Optionally, the time series may be Box-Cox transformed before decomposition.
Unlike stl, mstl is completely automated."><meta property="og:image" content="https://feasts.tidyverts.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="feasts.tidyverts.org" src="https://track.mitchelloharawild.com/js/plausible.js"></script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">feasts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/feasts.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.mitchelloharawild.com/blog/feasts/" class="external-link">Version 0.1.0</a>
    </li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tidyverts/feasts" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple seasonal decomposition by Loess</h1>
    <small class="dont-index">Source: <a href="https://github.com/tidyverts/feasts/blob/main/R/stl.R" class="external-link"><code>R/stl.R</code></a></small>
    <div class="hidden name"><code>STL.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Decompose a time series into seasonal, trend and remainder components.
Seasonal components are estimated iteratively using STL. Multiple seasonal periods are
allowed. The trend component is computed for the last iteration of STL.
Non-seasonal time series are decomposed into trend and remainder only.
In this case, <code><a href="https://rdrr.io/r/stats/supsmu.html" class="external-link">supsmu</a></code> is used to estimate the trend.
Optionally, the time series may be Box-Cox transformed before decomposition.
Unlike <code><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stl</a></code>, <code>mstl</code> is completely automated.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">STL</span><span class="op">(</span><span class="va">formula</span>, iterations <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Decomposition specification (see "Specials" section).</p></dd>


<dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>Number of iterations to use to refine the seasonal component.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stats::stl()</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code><a href="https://fabletools.tidyverts.org/reference/dable.html" class="external-link">fabletools::dable()</a></code> containing the decomposed trend, seasonality
and remainder from the STL decomposition.</p>
    </div>
    <div id="specials">
    <h2>Specials</h2>



<div class="section">
<h3 id="trend">trend<a class="anchor" aria-label="anchor" href="#trend"></a></h3>
<p>The <code>trend</code> special is used to specify the trend extraction parameters.</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">trend</span><span class="op">(</span><span class="va">window</span>, <span class="va">degree</span>, <span class="va">jump</span><span class="op">)</span></span></code></pre></div>

<table class="table table"><tr><td><code>window</code></td><td>The span (in lags) of the loess window, which should be odd. If NULL, the default, nextodd(ceiling((1.5*period) / (1-(1.5/s.window)))), is taken.</td></tr><tr><td><code>degree</code></td><td>The degree of locally-fitted polynomial. Should be zero or one.</td></tr><tr><td><code>jump</code></td><td>Integers at least one to increase speed of the respective smoother. Linear interpolation happens between every <code>jump</code>th value.</td></tr></table></div>

<div class="section">
<h3 id="season">season<a class="anchor" aria-label="anchor" href="#season"></a></h3>
<p>The <code>season</code> special is used to specify the season extraction parameters.</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">season</span><span class="op">(</span>period <span class="op">=</span> <span class="cn">NULL</span>, window <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">degree</span>, <span class="va">jump</span><span class="op">)</span></span></code></pre></div>

<table class="table table"><tr><td><code>period</code></td><td>The periodic nature of the seasonality. This can be either a number indicating the number of observations in each seasonal period, or text to indicate the duration of the seasonal window (for example, annual seasonality would be "1 year").</td></tr><tr><td><code>window</code></td><td>The span (in lags) of the loess window, which should be odd. If the <code>window</code> is set to <code>"periodic"</code> or <code>Inf</code>, the seasonal pattern will be fixed. The window size should be odd and at least 7, according to Cleveland et al. The default (NULL) will choose an appropriate default, for a dataset with one seasonal pattern this would be 11, the second larger seasonal window would be 15, then 19, 23, ... onwards.</td></tr><tr><td><code>degree</code></td><td>The degree of locally-fitted polynomial. Should be zero or one.</td></tr><tr><td><code>jump</code></td><td>Integers at least one to increase speed of the respective smoother. Linear interpolation happens between every <code>jump</code>th value.</td></tr></table></div>

<div class="section">
<h3 id="lowpass">lowpass<a class="anchor" aria-label="anchor" href="#lowpass"></a></h3>
<p>The <code>lowpass</code> special is used to specify the low-pass filter parameters.</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu">lowpass</span><span class="op">(</span><span class="va">window</span>, <span class="va">degree</span>, <span class="va">jump</span><span class="op">)</span></span></code></pre></div>

<table class="table table"><tr><td><code>window</code></td><td>The span (in lags) of the loess window of the low-pass filter used for each subseries. Defaults to the smallest odd integer greater than or equal to the seasonal <code>period</code> which is recommended since it prevents competition between the trend and seasonal components. If not an odd integer its given value is increased to the next odd one.</td></tr><tr><td><code>degree</code></td><td>The degree of locally-fitted polynomial. Must be zero or one.</td></tr><tr><td><code>jump</code></td><td>Integers at least one to increase speed of the respective smoother. Linear interpolation happens between every <code>jump</code>th value.</td></tr></table></div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>R. B. Cleveland, W. S. Cleveland, J.E. McRae, and I. Terpenning (1990) STL: A Seasonal-Trend Decomposition Procedure Based on Loess. Journal of Official Statistics, 6, 3–73.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stl</a></code>, <code><a href="https://rdrr.io/r/stats/supsmu.html" class="external-link">supsmu</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">as_tsibble</a></span><span class="op">(</span><span class="va">USAccDeaths</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://fabletools.tidyverts.org/reference/model.html" class="external-link">model</a></span><span class="op">(</span><span class="fu">STL</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="fu">trend</span><span class="op">(</span>window <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A dable: 72 x 7 [1M]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Key:     .model [1]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># :        value = trend + season_year + remainder</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .model                  index value trend season_year remainder season_adjust</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;mth&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> STL(value ~ trend(w… 1973 Jan  <span style="text-decoration: underline;">9</span>007 <span style="text-decoration: underline;">9</span>676.       -<span style="color: #BB0000;">792.</span>     123.          <span style="text-decoration: underline;">9</span>799.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> STL(value ~ trend(w… 1973 Feb  <span style="text-decoration: underline;">8</span>106 <span style="text-decoration: underline;">9</span>691.      -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">510.</span>     -<span style="color: #BB0000;">75.1</span>         <span style="text-decoration: underline;">9</span>616.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> STL(value ~ trend(w… 1973 Mar  <span style="text-decoration: underline;">8</span>928 <span style="text-decoration: underline;">9</span>706.       -<span style="color: #BB0000;">707.</span>     -<span style="color: #BB0000;">70.7</span>         <span style="text-decoration: underline;">9</span>635.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> STL(value ~ trend(w… 1973 Apr  <span style="text-decoration: underline;">9</span>137 <span style="text-decoration: underline;">9</span>720.       -<span style="color: #BB0000;">522.</span>     -<span style="color: #BB0000;">61.2</span>         <span style="text-decoration: underline;">9</span>659.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> STL(value ~ trend(w… 1973 May <span style="text-decoration: underline;">10</span>017 <span style="text-decoration: underline;">9</span>733.        325.     -<span style="color: #BB0000;">41.3</span>         <span style="text-decoration: underline;">9</span>692.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> STL(value ~ trend(w… 1973 Jun <span style="text-decoration: underline;">10</span>826 <span style="text-decoration: underline;">9</span>753.        843.     229.          <span style="text-decoration: underline;">9</span>983.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> STL(value ~ trend(w… 1973 Jul <span style="text-decoration: underline;">11</span>317 <span style="text-decoration: underline;">9</span>764.       <span style="text-decoration: underline;">1</span>617.     -<span style="color: #BB0000;">64.5</span>         <span style="text-decoration: underline;">9</span>700.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> STL(value ~ trend(w… 1973 Aug <span style="text-decoration: underline;">10</span>744 <span style="text-decoration: underline;">9</span>734.        981.      28.4         <span style="text-decoration: underline;">9</span>763.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> STL(value ~ trend(w… 1973 Sep  <span style="text-decoration: underline;">9</span>713 <span style="text-decoration: underline;">9</span>638.       -<span style="color: #BB0000;">105.</span>     181.          <span style="text-decoration: underline;">9</span>818.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> STL(value ~ trend(w… 1973 Oct  <span style="text-decoration: underline;">9</span>938 <span style="text-decoration: underline;">9</span>473.        232.     233.          <span style="text-decoration: underline;">9</span>706.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 62 more rows</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://mitchelloharawild.com" class="external-link">Mitchell O’Hara-Wild</a>, <a href="http://robjhyndman.com" class="external-link">Rob Hyndman</a>, <a href="https://earo.me" class="external-link">Earo Wang</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

